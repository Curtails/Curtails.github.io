<html>
<head>
	
	<title>BugKuCTF-论剑场-Web-WriteUp</title>
	<meta name="keywords" content="Curtails的blog" />

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    
	   <link href="/css/main.css?v=3" rel="stylesheet" type="text/css" />
    
        <script src="/js/util.js"></script>
        <script>
            if(isMobile()) {
                loadjscssfile('../css/mobile.css', 'css');
            } else {
                loadjscssfile('../css/desktop.css', 'css');
            }
        </script> 
    

    <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom feed">

    
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=3"/>
    
    

</head>

<body>


<h2 class="title">BugKuCTF-论剑场-Web-WriteUp</h2>
<!---
<div style="text-align:center;margin-top: -10px;">
<div class="article-category">
发表于2019年8月31日




 </div>
--->
</div>

<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web26"><span class="toc-text">web26</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web1"><span class="toc-text">web1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web9"><span class="toc-text">web9</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#流量分析"><span class="toc-text">流量分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web2"><span class="toc-text">web2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web5"><span class="toc-text">web5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web6"><span class="toc-text">web6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web11"><span class="toc-text">web11</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web13"><span class="toc-text">web13</span></a></li></ol>
<p>BugKuCTF-论剑场-Web-WriteUp</p>
<h2 id="web26"><a href="#web26" class="headerlink" title="web26"></a>web26</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$num=$_GET[<span class="string">'num'</span>];</span><br><span class="line">$str=$_GET[<span class="string">'str'</span>];</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($num)&amp;&amp;<span class="keyword">isset</span>($str)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/\d+/sD'</span>,$str)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"vagetable hhhh"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    $result=is_numeric($num) <span class="keyword">and</span> is_numeric($str);</span><br><span class="line">    <span class="keyword">if</span> ($result) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"$flag"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"vagetablessssss"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>看到正则傻了 直接用GLOBALS</li>
<li>payload<code>?str=GLOBALS&amp;num=1</code></li>
<li>flag{f0058a1d652f13d6}</li>
</ul>
<h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><p>打开网址是一张有代码图片 一道代码审计题 涉及extract变量覆盖</p>
<ul>
<li>payload<code>?a=&amp;b=</code></li>
<li>flag{c3fd1661da5efb989c72b91f3c378759} </li>
</ul>
<h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><p>打开显示<code>put me a message bugku then you can get the flag</code></p>
<ul>
<li>打开bp抓包 传参方式GET改成PUT 空一行加上<code>bugku</code> -go</li>
<li>得<code>ZmxhZ3tUN2w4eHM5ZmMxbmN0OE52aVBUYm4zZkcwZHpYOVZ9</code>bsae64解码</li>
<li>flag{T7l8xs9fc1nct8NviPTbn3fG0dzX9V}</li>
</ul>
<h2 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h2><p>下载得bugku.pcapng</p>
<ul>
<li>追踪流tcp 看到password为flag</li>
<li>flag{bugku123456}</li>
</ul>
<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>这种几秒的计算题然后提交 需要写py<br>留坑</p>
<h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>hint:injection 题目好像挂了</p>
<h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>管理员系统 bugkuctf一样的题</p>
<ul>
<li>源代码注释base64解码test123</li>
<li>随便输 <code>IP禁止访问，请联系本地管理员登陆，IP已被记录.</code></li>
<li>bp抓包 账户admin 密码test123</li>
<li>加上X-Forwarded-For: 127.0.0.1</li>
<li>flag{85ff2ee4171396724bae20c0bd851f6b}</li>
</ul>
<h2 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h2><p>需要py</p>
<h2 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h2><p>需要py</p>


<!--<a href="https://curtails.github.io/2019/08/31/Bugkuljc-web-writeup/#disqus_thread" class="article-comment-link">Comments</a>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = ''; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
-->
<div style="display:none">
<script src="http://s4.cnzz.com/stat.php?id=&web_id=" language="JavaScript"></script>script>
</div>






</body>
</html>